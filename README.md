# ConverToDazz

Простой настольный конвертер изображений и аудио на WinForms.  
Использует **Magick.NET** для изображений и **FFmpeg** для аудио. Поддерживает популярные форматы и предоставляет прогресс конверсии, безопасное сохранение и локализацию.

---

## Возможности

- Конвертация изображений между:
  - `jpg/jpeg`, `png`, `webp`, `avif`, `bmp`, `tiff`, `ico` (генерация ICO с набором стандартных размеров)
- Конвертация аудио между:
  - `mp3`, `wav`, `ogg`, `flac`, `aac`, `wma`
- Автоопределение формата входного файла и блокировка выбора после определения
- Превью изображений и отображение информации о файле:
  - Размер файла
  - Дата последнего изменения
- Прогресс-бар для аудио (реальный прогресс через `out_time_ms` FFmpeg)
- Сохранение результата по выбору пользователя
- Возможность открыть файл или папку через стандартные приложения
- Локализация интерфейса (русский по умолчанию, английский при системном языке не `ru`)
- Надёжное управление формами — приложение корректно закрывается при завершении

---

## Поддерживаемые форматы

**Изображения:**  
`jpg`, `jpeg`, `png`, `webp`, `avif`, `bmp`, `tiff`, `ico`

**Аудио:**  
`mp3`, `wav`, `ogg`, `flac`, `aac`, `wma`

---

## Системные требования

- Windows (WinForms)
- .NET 6 / 7 / 8
- Magick.NET (`NuGet`) — для работы с изображениями
- FFmpeg (`ffmpeg.exe`) — для конвертации аудио:
  - Поместить рядом с `YourApp.exe` или добавить в PATH

---

## Установка и запуск

1. Склонируйте репозиторий или распакуйте исходники.
2. Откройте проект в Visual Studio.
3. Установите NuGet пакет **Magick.NET-Q8-AnyCPU**.
4. Скопируйте `ffmpeg.exe` в папку `bin\Debug\netX` рядом с `YourApp.exe` или добавьте его в PATH.
5. Соберите проект и запустите `YourApp.exe`.

---

## Как пользоваться

### Конвертер изображений

1. Нажмите **Выбор файла** и выберите изображение.
   - Имя файла подтянется в `txtBoxFname` (можно редактировать)
   - `cmbChooseIn` автоматически заполнится и заблокируется
   - Появится превью
   - `txtBoxSize` и `txtBoxChange` — размер и дата изменения исходного файла
2. Выберите выходной формат в `cmbChooseOu`.
3. Нажмите **Конвертация**.
4. Нажмите **Сохранить**, чтобы выбрать путь и имя.

### Конвертер аудио

1. Нажмите **Выбор файла**, выберите аудиофайл.
   - Появятся имя, длительность, битрейт
   - `cmbChooseIn` заблокирован
2. Выберите выходной формат в `cmbChooseOu`.
3. Нажмите **Конвертация** — прогресс отображается в `progBar`.
4. По завершении нажмите **Сохранить**.

---

## Локализация

- UI строки формы через локализованные `.resx` файлы (`FormName.resx`, `FormName.en.resx`)
- Общие сообщения через `Resources.resx` и `Resources.en.resx`
- При запуске программа определяет язык системы и устанавливает `CurrentUICulture` (`en` если язык не `ru`)

---

## Отладка и советы

- **FFmpeg не найден** — поместите `ffmpeg.exe` рядом с приложением или добавьте в PATH
- **UI зависает при конвертации аудио** — убедитесь, что используется `async/await` + `Task.Run`
- **ICO выглядит маленьким** — добавьте большие размеры (128/256 px) при генерации ICO
- **Двойные действия** — проверяйте дублированные события (`+=`) в Designer и коде

---

## Полезные фрагменты кода

- Открыть папку с файлом:
```csharp
Process.Start("explorer.exe", $"/select,\"{filePath}\"");
